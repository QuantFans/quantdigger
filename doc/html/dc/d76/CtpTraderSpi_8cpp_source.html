<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>EasyQuant: CtpTraderSpi.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EasyQuant
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d76/CtpTraderSpi_8cpp_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CtpTraderSpi.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d76/CtpTraderSpi_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d8a/ThostFtdcTraderApi_8h.html" title="定义了客户端接口  20060106 赵鸿昊 创建该文件">ctp/ThostFtdcTraderApi.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d52/CtpTraderSpi_8h.html">CtpTraderSpi.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d22/CSem_8h.html">CSem.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">   13</a></span>&#160;<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acd6c8580ebbbe635193a0830efc38356">TThostFtdcBrokerIDType</a> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>;       <span class="comment">// 应用单元</span></div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">   14</a></span>&#160;<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#afc98e13af8f2251cef1a3ad789e0de4b">TThostFtdcUserIDType</a> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>;        <span class="comment">// 投资者代码</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../d1/d9c/classCSem.html">CSem</a> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// 会话参数</span></div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a7472738431d9e0120018419be6a67913">   21</a></span>&#160;<span class="keywordtype">int</span>  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a7472738431d9e0120018419be6a67913">frontId</a>;   <span class="comment">//前置编号</span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a0768ca718e1d7e956edb993d4ca6e7bf">   22</a></span>&#160;<span class="keywordtype">int</span>  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a0768ca718e1d7e956edb993d4ca6e7bf">sessionId</a>; <span class="comment">//会话编号</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a920df06a49c98144b9608c835fd32ade">   23</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a920df06a49c98144b9608c835fd32ade">orderRef</a>[13];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">   25</a></span>&#160;vector&lt;CThostFtdcOrderField*&gt; <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">   26</a></span>&#160;vector&lt;CThostFtdcTradeField*&gt; <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keywordtype">char</span> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">MapDirection</a>(<span class="keywordtype">char</span> src, <span class="keywordtype">bool</span> toOrig);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keywordtype">char</span> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ab5a608415c729226cb7d80e01e191857">MapOffset</a>(<span class="keywordtype">char</span> src, <span class="keywordtype">bool</span> toOrig);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a8c26b263d95592cd2b9d325e0d185896">   33</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a8c26b263d95592cd2b9d325e0d185896" title="当客户端与交易后台建立起通信连接时（还未登录前），该方法被调用。">CtpTraderSpi::OnFrontConnected</a>()</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 连接交易前置...成功&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    ReqUserLogin(<span class="stringliteral">&quot;1035&quot;</span>, <span class="stringliteral">&quot;00000071&quot;</span>, <span class="stringliteral">&quot;123456&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a65cc1da645cdca2e1f896eba6214409f">   41</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a65cc1da645cdca2e1f896eba6214409f" title="用户登录请求">CtpTraderSpi::ReqUserLogin</a>(<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acd6c8580ebbbe635193a0830efc38356">TThostFtdcBrokerIDType</a>  vAppId,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#afc98e13af8f2251cef1a3ad789e0de4b">TThostFtdcUserIDType</a>    vUserId,    <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#af2a416e6e9f76db6dda13c8802f6b95a">TThostFtdcPasswordType</a>  vPasswd)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="../../db/d52/structCThostFtdcReqUserLoginField.html" title="用户登录请求">CThostFtdcReqUserLoginField</a> req;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    strcpy(req.<a class="code" href="../../db/d52/structCThostFtdcReqUserLoginField.html#ab7ecc4457fd804e609485f934e619f6c" title="经纪公司代码">BrokerID</a>, vAppId); strcpy(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>, vAppId); </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    strcpy(req.<a class="code" href="../../db/d52/structCThostFtdcReqUserLoginField.html#a06c0dcabf31dd027e463fb95a0e3cf6a" title="用户代码">UserID</a>, vUserId);  strcpy(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>, vUserId); </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    strcpy(req.<a class="code" href="../../db/d52/structCThostFtdcReqUserLoginField.html#a1eda26166a7be307d2167aa18265ab55" title="密码">Password</a>, vPasswd);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqUserLogin(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; sending | 发送登录...&quot;</span>&lt;&lt;((ret == 0) ? <span class="stringliteral">&quot;成功&quot;</span> :<span class="stringliteral">&quot;失败&quot;</span>) &lt;&lt; endl;  </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#aed56cc2349490fa54a30b055bdd7709e">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#aed56cc2349490fa54a30b055bdd7709e" title="登录请求响应">CtpTraderSpi::OnRspUserLogin</a>(<a class="code" href="../../d5/d15/structCThostFtdcRspUserLoginField.html" title="用户登录应答">CThostFtdcRspUserLoginField</a> *pRspUserLogin,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> ( !IsErrorRspInfo(pRspInfo) &amp;&amp; pRspUserLogin ) {  </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// 保存会话参数   </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a7472738431d9e0120018419be6a67913">frontId</a> = pRspUserLogin-&gt;<a class="code" href="../../d5/d15/structCThostFtdcRspUserLoginField.html#aca685fe1183cf96ce4022ce12ec660b3" title="前置编号">FrontID</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a0768ca718e1d7e956edb993d4ca6e7bf">sessionId</a> = pRspUserLogin-&gt;<a class="code" href="../../d5/d15/structCThostFtdcRspUserLoginField.html#aff985a20646ce281c84508968312a3d3" title="会话编号">SessionID</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordtype">int</span> nextOrderRef = atoi(pRspUserLogin-&gt;<a class="code" href="../../d5/d15/structCThostFtdcRspUserLoginField.html#afb248c5d70414fee170423fe73fb6936" title="最大报单引用">MaxOrderRef</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        sprintf(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a920df06a49c98144b9608c835fd32ade">orderRef</a>, <span class="stringliteral">&quot;%d&quot;</span>, ++nextOrderRef);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;       cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 登录成功...当前交易日:&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       &lt;&lt;pRspUserLogin-&gt;<a class="code" href="../../d5/d15/structCThostFtdcRspUserLoginField.html#aee1db6329dd006899bd5d17b40946720" title="交易日">TradingDay</a>&lt;&lt;endl;     </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordtype">char</span> *ru = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        ReqQryInstrument(ru);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#abd7cf48a8dfd35fa6b07bd5e402bd1e5">   71</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#abd7cf48a8dfd35fa6b07bd5e402bd1e5" title="投资者结算结果确认">CtpTraderSpi::ReqSettlementInfoConfirm</a>()</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html" title="投资者结算结果确认信息">CThostFtdcSettlementInfoConfirmField</a> req;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    strcpy(req.<a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html#a7727bc44c17baac5253a1ff2fa46382a" title="经纪公司代码">BrokerID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    strcpy(req.<a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html#a4708741d8aa53454c7fc67b28ea2157f" title="投资者代码">InvestorID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqSettlementInfoConfirm(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 发送结算单确认...&quot;</span>&lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>)&lt;&lt;endl;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a3319ff3d9534ca6f844bd5a3a2cce15c">   81</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a3319ff3d9534ca6f844bd5a3a2cce15c" title="投资者结算结果确认响应">CtpTraderSpi::OnRspSettlementInfoConfirm</a>(</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html" title="投资者结算结果确认信息">CThostFtdcSettlementInfoConfirmField</a>  *pSettlementInfoConfirm, </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{   </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span>( !IsErrorRspInfo(pRspInfo) &amp;&amp; pSettlementInfoConfirm){</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 结算单...&quot;</span>&lt;&lt;pSettlementInfoConfirm-&gt;<a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html#a4708741d8aa53454c7fc67b28ea2157f" title="投资者代码">InvestorID</a></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      &lt;&lt;<span class="stringliteral">&quot;...&lt;&quot;</span>&lt;&lt;pSettlementInfoConfirm-&gt;<a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html#a90a1f7b9a1906f9e88c2660d31a1f6a2" title="确认日期">ConfirmDate</a></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pSettlementInfoConfirm-&gt;<a class="code" href="../../db/db6/structCThostFtdcSettlementInfoConfirmField.html#ab5eedc04394e72335742175a099d2e53" title="确认时间">ConfirmTime</a>&lt;&lt;<span class="stringliteral">&quot;&gt;...确认&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#aa4545cfbfd0c07d0299978a0dc28fcfa">   93</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#aa4545cfbfd0c07d0299978a0dc28fcfa" title="请求查询合约">CtpTraderSpi::ReqQryInstrument</a>(<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acd167f1e08ae0058dee44c6c98afdde7">TThostFtdcInstrumentIDType</a> instId)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../d3/d40/structCThostFtdcQryInstrumentField.html" title="查询合约">CThostFtdcQryInstrumentField</a> req;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    strcpy(req.<a class="code" href="../../d3/d40/structCThostFtdcQryInstrumentField.html#aa9c96b032147ff3903e9b61774919a13" title="合约代码">InstrumentID</a>, instId);<span class="comment">//为空表示查询所有合约</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqQryInstrument(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 发送合约查询...&quot;</span>&lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>)&lt;&lt;endl;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    cerr&lt;&lt;ret&lt;&lt;endl;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a180b4d481b490cd655c86ba23cd684fa">  103</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a180b4d481b490cd655c86ba23cd684fa" title="请求查询合约响应">CtpTraderSpi::OnRspQryInstrument</a>(<a class="code" href="../../da/d2b/structCThostFtdcInstrumentField.html" title="合约">CThostFtdcInstrumentField</a> *pInstrument, </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;         <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{   </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> ( !IsErrorRspInfo(pRspInfo) &amp;&amp;  pInstrument){</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 合约:&quot;</span>&lt;&lt;pInstrument-&gt;<a class="code" href="../../da/d2b/structCThostFtdcInstrumentField.html#ad14d830a9811264ae53213bb4ac624b6" title="合约代码">InstrumentID</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 交割月:&quot;</span>&lt;&lt;pInstrument-&gt;<a class="code" href="../../da/d2b/structCThostFtdcInstrumentField.html#ac0fccce9f9828e77bae7bb33ad661e98" title="交割月">DeliveryMonth</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 多头保证金率:&quot;</span>&lt;&lt;pInstrument-&gt;<a class="code" href="../../da/d2b/structCThostFtdcInstrumentField.html#af185f2b4b4fabf9c11cffe801946b5b1" title="多头保证金率">LongMarginRatio</a></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 交易所代码:&quot;</span>&lt;&lt;pInstrument-&gt;<a class="code" href="../../da/d2b/structCThostFtdcInstrumentField.html#a5df2b13989e4eed35e1e674bf01adaf7" title="交易所代码">ExchangeID</a></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 空头保证金率:&quot;</span>&lt;&lt;pInstrument-&gt;<a class="code" href="../../da/d2b/structCThostFtdcInstrumentField.html#a377c2562866a764a86355431b78508b1" title="空头保证金率">ShortMarginRatio</a>&lt;&lt;endl;    </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#ab1499c16fe4a3e37ac24bf385c7c1010">  116</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#ab1499c16fe4a3e37ac24bf385c7c1010" title="查询合约的最新报价">CtpTraderSpi::ReqQryDepthMarketData</a>(<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acd167f1e08ae0058dee44c6c98afdde7">TThostFtdcInstrumentIDType</a> instId)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;{</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="../../d2/d5a/structCThostFtdcQryDepthMarketDataField.html" title="查询行情">CThostFtdcQryDepthMarketDataField</a> req;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    strcpy(req.<a class="code" href="../../d2/d5a/structCThostFtdcQryDepthMarketDataField.html#adceb797cef348ce2bcb232f436ac1ab3" title="合约代码">InstrumentID</a>, instId);<span class="comment">//为空表示查询所有合约</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqQryDepthMarketData(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 发送合约报价查询...&quot;</span>&lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>)&lt;&lt;endl;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    cerr&lt;&lt;ret&lt;&lt;endl;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6ecce624cdc963fa873dffeec7ccfeac">  126</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6ecce624cdc963fa873dffeec7ccfeac" title="最新的合约报价">CtpTraderSpi::OnRspQryDepthMarketData</a>(<a class="code" href="../../d0/dba/structCThostFtdcDepthMarketDataField.html" title="深度行情">CThostFtdcDepthMarketDataField</a> *pDepthMarketData,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> ( !IsErrorRspInfo(pRspInfo) &amp;&amp; pDepthMarketData){</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 合约:&quot;</span>&lt;&lt;pDepthMarketData-&gt;<a class="code" href="../../d0/dba/structCThostFtdcDepthMarketDataField.html#ad1015b8a040b34d16b4298eca648368e" title="合约代码">InstrumentID</a>&lt;&lt;endl</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        &lt;&lt;<span class="stringliteral">&quot;申买价一:&quot;</span>&lt;&lt;pDepthMarketData-&gt;<a class="code" href="../../d0/dba/structCThostFtdcDepthMarketDataField.html#a344f411bb2005a58dbf7638c541acf80" title="申买价一">BidPrice1</a> &lt;&lt;endl;    </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6619f69d3b171f59a1489350ead96407">  136</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6619f69d3b171f59a1489350ead96407" title="请求查询资金账户">CtpTraderSpi::ReqQryTradingAccount</a>()</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="../../d2/d0d/structCThostFtdcQryTradingAccountField.html" title="查询资金账户">CThostFtdcQryTradingAccountField</a> req;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    strcpy(req.<a class="code" href="../../d2/d0d/structCThostFtdcQryTradingAccountField.html#ab363bf5a84e25f896cc30ac645cc719a" title="经纪公司代码">BrokerID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    strcpy(req.<a class="code" href="../../d2/d0d/structCThostFtdcQryTradingAccountField.html#a49dd46898f0cd062e255ecabbb4494be" title="投资者代码">InvestorID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqQryTradingAccount(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 发送资金查询...&quot;</span>&lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>)&lt;&lt;endl;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#ac426f67085c27df152c54edf4c668a9c">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#ac426f67085c27df152c54edf4c668a9c" title="请求查询资金账户响应">CtpTraderSpi::OnRspQryTradingAccount</a>(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html" title="资金账户">CThostFtdcTradingAccountField</a> *pTradingAccount, </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{ </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (!IsErrorRspInfo(pRspInfo) &amp;&amp;  pTradingAccount){</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 权益:&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#a3d549baae3044cf4e50577d7cd857772" title="期货结算准备金">Balance</a></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 可用:&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#a6297e50b50373cc966d7c75d356b3a7f" title="可用资金">Available</a>   </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 保证金:&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#a0116e1c5c07be8d7f1ca5beb09692791" title="当前保证金总额">CurrMargin</a></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 平仓盈亏:&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#ae044d828947be5b9de8d0adf6493582c" title="平仓盈亏">CloseProfit</a></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 持仓盈亏&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#af92dd3805bc7325790f98ac3eaa39913" title="持仓盈亏">PositionProfit</a></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 手续费:&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#a17081a6a7945d9199b9f4f92b7c00089" title="手续费">Commission</a></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 冻结保证金:&quot;</span>&lt;&lt;pTradingAccount-&gt;<a class="code" href="../../d7/de0/structCThostFtdcTradingAccountField.html#a41c9351944f00eb68e830d8bfc2669e4" title="冻结的保证金">FrozenMargin</a></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">//&lt;&lt;&quot; 冻结手续费:&quot;&lt;&lt;pTradingAccount-&gt;FrozenCommission </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      &lt;&lt; endl;    </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#ae0a4a7d14ed3ccc148661146edd2a53f">  165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#ae0a4a7d14ed3ccc148661146edd2a53f" title="请求查询投资者持仓">CtpTraderSpi::ReqQryInvestorPosition</a>(<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acd167f1e08ae0058dee44c6c98afdde7">TThostFtdcInstrumentIDType</a> instId)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../d7/d7a/structCThostFtdcQryInvestorPositionField.html" title="查询投资者持仓">CThostFtdcQryInvestorPositionField</a> req;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    strcpy(req.<a class="code" href="../../d7/d7a/structCThostFtdcQryInvestorPositionField.html#a3e85c72d5fce19d8f50386bdde517e29" title="经纪公司代码">BrokerID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    strcpy(req.<a class="code" href="../../d7/d7a/structCThostFtdcQryInvestorPositionField.html#a16a238b053f58ff82c4ec0b1dd9aa74c" title="投资者代码">InvestorID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    strcpy(req.<a class="code" href="../../d7/d7a/structCThostFtdcQryInvestorPositionField.html#a4d187b8977e5b9c9808a62cb8c6ef518" title="合约代码">InstrumentID</a>, instId);   </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqQryInvestorPosition(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 发送持仓查询...&quot;</span>&lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>)&lt;&lt;endl;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6418c93dced14ffebdce8fb1bdb2f029">  176</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6418c93dced14ffebdce8fb1bdb2f029" title="请求查询投资者持仓响应">CtpTraderSpi::OnRspQryInvestorPosition</a>(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html" title="投资者持仓">CThostFtdcInvestorPositionField</a> *pInvestorPosition, </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{ </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span>( !IsErrorRspInfo(pRspInfo) &amp;&amp;  pInvestorPosition ){</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 合约:&quot;</span>&lt;&lt;pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#a56ed8c3dc345d0175dbad9d38b402689" title="合约代码">InstrumentID</a></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 方向:&quot;</span>&lt;&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">MapDirection</a>(pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#acbaa3db9ff6d28ee54cebd7b3867a21f" title="持仓多空方向">PosiDirection</a>-2,<span class="keyword">false</span>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 总持仓:&quot;</span>&lt;&lt;pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#a6c1784013007d0a29d605d112f518365" title="今日持仓">Position</a></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 昨仓:&quot;</span>&lt;&lt;pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#aa9a04b24a1d586ca8e0ddc8f3c93749a" title="上日持仓">YdPosition</a> </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 今仓:&quot;</span>&lt;&lt;pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#ac2cd010c5aa6846a0deb0251f7dfd6fa" title="今日持仓">TodayPosition</a></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 持仓盈亏:&quot;</span>&lt;&lt;pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#a766bf45962c905445e1994bef0214eaf" title="持仓盈亏">PositionProfit</a></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 保证金:&quot;</span>&lt;&lt;pInvestorPosition-&gt;<a class="code" href="../../d0/d07/structCThostFtdcInvestorPositionField.html#a9baf9b21285dea8d2f94f9b821f025c2" title="占用的保证金">UseMargin</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a4c83aabbc8921cc9e1437a086c783744">  192</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a4c83aabbc8921cc9e1437a086c783744" title="报单录入请求">CtpTraderSpi::ReqOrderInsert</a>(<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acd167f1e08ae0058dee44c6c98afdde7">TThostFtdcInstrumentIDType</a> instId,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a561d91e2a6dbe99f5ff1efb669878058">TThostFtdcDirectionType</a> dir, <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#af4ba892b8831b22c3137e8cc11dcb04b">TThostFtdcCombOffsetFlagType</a> kpp,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a141bdc8b938e6450abed9b09a97f0378">TThostFtdcPriceType</a> price,   <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#ad47f2c2464544997759cf5f91489656a">TThostFtdcVolumeType</a> vol)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html" title="输入报单">CThostFtdcInputOrderField</a> req;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));   </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    strcpy(req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#afaa29f6413a1d289b7bdd5f93bdaf050" title="经纪公司代码">BrokerID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>);  <span class="comment">//应用单元代码  </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    strcpy(req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#aee443356de31114374c8944aa035a1ba" title="投资者代码">InvestorID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>); <span class="comment">//投资者代码   </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    strcpy(req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a6e12097d25e8fa990c4240d4b699c5bf" title="合约代码">InstrumentID</a>, instId); <span class="comment">//合约代码    </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    strcpy(req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#af7430d4ee8f7b914b224abfdd969c41f" title="报单引用">OrderRef</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a920df06a49c98144b9608c835fd32ade">orderRef</a>);  <span class="comment">//报单引用</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">int</span> nextOrderRef = atoi(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a920df06a49c98144b9608c835fd32ade">orderRef</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  sprintf(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a920df06a49c98144b9608c835fd32ade">orderRef</a>, <span class="stringliteral">&quot;%d&quot;</span>, ++nextOrderRef);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#ac50f0130a0e50ca3170fbe7851df5dc1" title="价格">LimitPrice</a> = price;   <span class="comment">//价格</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span>(0==req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#ac50f0130a0e50ca3170fbe7851df5dc1" title="价格">LimitPrice</a>){</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a1b90c5a80d82e81fb406b453901db9b9" title="报单价格条件">OrderPriceType</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#ae825a1e98e6d2f7b60a03f9aadba06b8">THOST_FTDC_OPT_AnyPrice</a>;<span class="comment">//价格类型=市价</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a2e0d8116df80d5833ef1164130fe7246" title="有效期类型">TimeCondition</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#abffdb0132f2fc06d57690782d2bc1e98">THOST_FTDC_TC_IOC</a>;<span class="comment">//有效期类型:立即完成，否则撤销</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a1b90c5a80d82e81fb406b453901db9b9" title="报单价格条件">OrderPriceType</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#acbf9127f9171f4c298a1750a43e81c8a" title="限价">THOST_FTDC_OPT_LimitPrice</a>;<span class="comment">//价格类型=限价    </span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a2e0d8116df80d5833ef1164130fe7246" title="有效期类型">TimeCondition</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a068e29918e83d4158fd869bc29f77b3c" title="当日有效">THOST_FTDC_TC_GFD</a>;  <span class="comment">//有效期类型:当日有效</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#ad53023e1601608f70bf10cafe14d0887" title="买卖方向">Direction</a> = <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">MapDirection</a>(dir,<span class="keyword">true</span>);  <span class="comment">//买卖方向   </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a40c9b64a7e7da61f63c8ef2edd2a830e" title="组合开平标志">CombOffsetFlag</a>[0] = <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ab5a608415c729226cb7d80e01e191857">MapOffset</a>(kpp[0],<span class="keyword">true</span>); <span class="comment">//组合开平标志:开仓</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a4719334d38d003e7937aa7a128893554" title="组合投机套保标志">CombHedgeFlag</a>[0] = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a23978fd528e30dc09d5fd93b750b6b78">THOST_FTDC_HF_Speculation</a>;     <span class="comment">//组合投机套保标志    </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#aa4f7ac809d52364b81f09b26ed74ff77" title="数量">VolumeTotalOriginal</a> = vol;  </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a90b02db73d69a1399d861eb0fd1104ed" title="成交量类型">VolumeCondition</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a24f4d077c479f2517bb3b4e92a8cf12f">THOST_FTDC_VC_AV</a>; <span class="comment">//成交量类型:任何数量</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#ae72e9dbb1cffbd0badca4d72d9bd94dd" title="最小成交量">MinVolume</a> = 1;  <span class="comment">//最小成交量:1 </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a1fcfc6c1ee86aa555f1346da59f8b144" title="触发条件">ContingentCondition</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#aef83925ad030210eb42b996a78a208fe">THOST_FTDC_CC_Immediately</a>;  <span class="comment">//触发条件:立即</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">//TThostFtdcPriceType StopPrice;  //止损价</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#a8853777470f25c77f180061835f61e1d" title="强平原因">ForceCloseReason</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a7101de06695654c2c4d89c21a30f20ae">THOST_FTDC_FCC_NotForceClose</a>;    <span class="comment">//强平原因:非强平    </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#abf32b35090094d1057e29e53476b5d72" title="自动挂起标志">IsAutoSuspend</a> = 0;  <span class="comment">//自动挂起标志:否    </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    req.<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#acdcc7842fdfd438b53867fa99919fe79" title="用户强评标志">UserForceClose</a> = 0;   <span class="comment">//用户强评标志:否</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqOrderInsert(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 发送报单...&quot;</span>&lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>)&lt;&lt; endl;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a72306c2c1a370201a70f6048a8236b53">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a72306c2c1a370201a70f6048a8236b53" title="报单录入请求响应">CtpTraderSpi::OnRspOrderInsert</a>(<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html" title="输入报单">CThostFtdcInputOrderField</a> *pInputOrder, </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span>( !IsErrorRspInfo(pRspInfo) &amp;&amp; pInputOrder ){</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot;响应 | 报单提交成功...报单引用:&quot;</span>&lt;&lt;pInputOrder-&gt;<a class="code" href="../../d0/d5b/structCThostFtdcInputOrderField.html#af7430d4ee8f7b914b224abfdd969c41f" title="报单引用">OrderRef</a>&lt;&lt;endl;  </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();  </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#aadfd85a5f1e4517c133730ecdd548586">  239</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#aadfd85a5f1e4517c133730ecdd548586" title="报单操作请求">CtpTraderSpi::ReqOrderAction</a>(<a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#aada18a188bfde5c8279525c521b68103">TThostFtdcSequenceNoType</a> orderSeq)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;{</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">bool</span> found=<span class="keyword">false</span>; <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>.size();i++){</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>[i]-&gt;BrokerOrderSeq == orderSeq){ found = <span class="keyword">true</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">if</span>(!found){cerr&lt;&lt;<span class="stringliteral">&quot; 请求 | 报单不存在.&quot;</span>&lt;&lt;endl; <span class="keywordflow">return</span>;} </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html" title="输入报单操作">CThostFtdcInputOrderActionField</a> req;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    strcpy(req.<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#a17315220c7b54dad787b08207a0a5d77" title="经纪公司代码">BrokerID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#adf24f583e7ed73901a9a966482b0e27d">appId</a>);   <span class="comment">//经纪公司代码 </span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    strcpy(req.<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#a4299b4d49ceb51ff156631876d30a722" title="投资者代码">InvestorID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a8a2ec01bd399d972575496b52b9ae090">userId</a>); <span class="comment">//投资者代码</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">//strcpy(req.OrderRef, pOrderRef); //报单引用   </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//req.FrontID = frontId;           //前置编号   </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//req.SessionID = sessionId;       //会话编号</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  strcpy(req.<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#a024c1073dbf24b9cf3ae16782b7d6dbb" title="交易所代码">ExchangeID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>[i]-&gt;ExchangeID);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  strcpy(req.<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#a508f194cb2091229ec8ce5520d7a2605" title="报单编号">OrderSysID</a>, <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>[i]-&gt;OrderSysID);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    req.<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#ac72ac8ec8847adc28c748c328edbac53" title="操作标志">ActionFlag</a> = <a class="code" href="../../d4/d23/ThostFtdcUserApiDataType_8h.html#a49e720f24b18614bb37b1d50fbf49dd3">THOST_FTDC_AF_Delete</a>;  <span class="comment">//操作标志 </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">int</span> ret = pUserApi-&gt;ReqOrderAction(&amp;req, ++<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a29069ed90dd5aeb496309302da4c4367">requestId</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    cerr&lt;&lt; <span class="stringliteral">&quot; 请求 | 发送撤单...&quot;</span> &lt;&lt;((ret == 0)?<span class="stringliteral">&quot;成功&quot;</span>:<span class="stringliteral">&quot;失败&quot;</span>) &lt;&lt; endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a46f425b4f7c3a844fc515aa99f1555ad">  262</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a46f425b4f7c3a844fc515aa99f1555ad" title="报单操作请求响应">CtpTraderSpi::OnRspOrderAction</a>(</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html" title="输入报单操作">CThostFtdcInputOrderActionField</a> *pInputOrderAction, </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{   </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">if</span> (!IsErrorRspInfo(pRspInfo) &amp;&amp; pInputOrderAction){</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    cerr&lt;&lt; <span class="stringliteral">&quot; 响应 | 撤单成功...&quot;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;交易所:&quot;</span>&lt;&lt;pInputOrderAction-&gt;<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#a024c1073dbf24b9cf3ae16782b7d6dbb" title="交易所代码">ExchangeID</a></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 报单编号:&quot;</span>&lt;&lt;pInputOrderAction-&gt;<a class="code" href="../../d7/d90/structCThostFtdcInputOrderActionField.html#a508f194cb2091229ec8ce5520d7a2605" title="报单编号">OrderSysID</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span>(bIsLast) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();  </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a7fb7b9e42123820e5b2095fc517f14a5">  275</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a7fb7b9e42123820e5b2095fc517f14a5" title="报单通知">CtpTraderSpi::OnRtnOrder</a>(<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html" title="报单">CThostFtdcOrderField</a> *pOrder)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{   </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="../../d7/d28/structCThostFtdcOrderField.html" title="报单">CThostFtdcOrderField</a>* order = <span class="keyword">new</span> <a class="code" href="../../d7/d28/structCThostFtdcOrderField.html" title="报单">CThostFtdcOrderField</a>();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  memcpy(order,  pOrder, <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html" title="报单">CThostFtdcOrderField</a>));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">bool</span> founded=<span class="keyword">false</span>;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>.size(); i++){</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>[i]-&gt;BrokerOrderSeq == order-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a7023b99f06c36a92cb74c7c923e3d2ca" title="经纪公司报单编号">BrokerOrderSeq</a>) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      founded=<span class="keyword">true</span>;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span>(founded) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>[i]= order;   </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">else</span>  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>.push_back(order);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  cerr&lt;&lt;<span class="stringliteral">&quot; 回报 | 报单已提交...序号:&quot;</span>&lt;&lt;order-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a7023b99f06c36a92cb74c7c923e3d2ca" title="经纪公司报单编号">BrokerOrderSeq</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();  </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a0e746bafc2e249c497334ab7f6239197">  292</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a0e746bafc2e249c497334ab7f6239197" title="成交通知">CtpTraderSpi::OnRtnTrade</a>(<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html" title="成交">CThostFtdcTradeField</a> *pTrade)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html" title="成交">CThostFtdcTradeField</a>* trade = <span class="keyword">new</span> <a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html" title="成交">CThostFtdcTradeField</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  memcpy(trade,  pTrade, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html" title="成交">CThostFtdcTradeField</a>));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordtype">bool</span> founded=<span class="keyword">false</span>;     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>.size(); i++){</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>[i]-&gt;TradeID == trade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#add29b05cd4578675a43905a5daa23c73" title="成交编号">TradeID</a>) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      founded=<span class="keyword">true</span>;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span>(founded) <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>[i] = trade;   </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">else</span>  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>.push_back(trade);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  cerr&lt;&lt;<span class="stringliteral">&quot; 回报 | 报单已成交...成交编号:&quot;</span>&lt;&lt;trade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#add29b05cd4578675a43905a5daa23c73" title="成交编号">TradeID</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#accc70dcdeaa5b20826189476cdc85b99">  308</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#accc70dcdeaa5b20826189476cdc85b99" title="当客户端与交易后台通信连接断开时，该方法被调用。当发生这个情况后，API会自动重新连接，客户端可不做处理。">CtpTraderSpi::OnFrontDisconnected</a>(<span class="keywordtype">int</span> nReason)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 连接中断...&quot;</span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; reason=&quot;</span> &lt;&lt; nReason &lt;&lt; endl;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        </div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a8d553cdd8160baaadc5d496a5da9b80f">  314</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a8d553cdd8160baaadc5d496a5da9b80f" title="心跳超时警告。当长时间未收到报文时，该方法被调用。">CtpTraderSpi::OnHeartBeatWarning</a>(<span class="keywordtype">int</span> nTimeLapse)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | 心跳超时警告...&quot;</span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; TimerLapse = &quot;</span> &lt;&lt; nTimeLapse &lt;&lt; endl;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#ae063560378dd38c91820f68187120a1d">  320</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#ae063560378dd38c91820f68187120a1d" title="错误应答">CtpTraderSpi::OnRspError</a>(<a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo, <span class="keywordtype">int</span> nRequestID, <span class="keywordtype">bool</span> bIsLast)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    IsErrorRspInfo(pRspInfo);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a8b2e32f9c1427ad525ff1647d180cc3a">  325</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a8b2e32f9c1427ad525ff1647d180cc3a" title="是否收到成功的响应">CtpTraderSpi::IsErrorRspInfo</a>(<a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html" title="响应信息">CThostFtdcRspInfoField</a> *pRspInfo)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// 如果ErrorID != 0, 说明收到了错误的响应</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">bool</span> ret = ((pRspInfo) &amp;&amp; (pRspInfo-&gt;<a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html#acec07f3c664574dd35e0c692e803b275" title="错误代码">ErrorID</a> != 0));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">if</span> (ret){</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 响应 | &quot;</span>&lt;&lt;pRspInfo-&gt;<a class="code" href="../../dd/de4/structCThostFtdcRspInfoField.html#a447dff8b3805c7a3ae8cac20e4b5ee47" title="错误信息">ErrorMsg</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#aaa7ee44b148c490cf7eaa9e10f14bd4e">  335</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#aaa7ee44b148c490cf7eaa9e10f14bd4e">CtpTraderSpi::PrintOrders</a>(){</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="../../d7/d28/structCThostFtdcOrderField.html" title="报单">CThostFtdcOrderField</a>* pOrder; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>.size(); i++){</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    pOrder = <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a73fbd43ee63c9d73208fd2268e3788e5">orderList</a>[i];</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 报单 | 合约:&quot;</span>&lt;&lt;pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a04dc3e16ccd9f96ca345c8d5ab916ae9" title="合约代码">InstrumentID</a></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 方向:&quot;</span>&lt;&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">MapDirection</a>(pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#aae54a6e14245162b89ff8690b702ad46" title="买卖方向">Direction</a>,<span class="keyword">false</span>)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 开平:&quot;</span>&lt;&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ab5a608415c729226cb7d80e01e191857">MapOffset</a>(pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#afaa43e3fefe5e8b5d4a2f41430a6198f" title="组合开平标志">CombOffsetFlag</a>[0],<span class="keyword">false</span>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 价格:&quot;</span>&lt;&lt;pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#ac6c7b0d4cc4318054d3d0836a9295f0f" title="价格">LimitPrice</a></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 数量:&quot;</span>&lt;&lt;pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a6d523f970c203e4aa70d7b7a9baa1957" title="数量">VolumeTotalOriginal</a></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 序号:&quot;</span>&lt;&lt;pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a7023b99f06c36a92cb74c7c923e3d2ca" title="经纪公司报单编号">BrokerOrderSeq</a> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 报单编号:&quot;</span>&lt;&lt;pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a65f68a6d83f4d6f5997ce2a9bbb10559" title="报单编号">OrderSysID</a></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 状态:&quot;</span>&lt;&lt;pOrder-&gt;<a class="code" href="../../d7/d28/structCThostFtdcOrderField.html#a1b009684b53a47dac8be63f34fbf9e0b" title="状态信息">StatusMsg</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6259da645ef18721b2015a5e578b2c4e">  350</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/db9/classCtpTraderSpi.html#a6259da645ef18721b2015a5e578b2c4e">CtpTraderSpi::PrintTrades</a>(){</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html" title="成交">CThostFtdcTradeField</a>* pTrade;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>.size(); i++){</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    pTrade = <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#a58b7169faf00348074d90f47ba670ce7">tradeList</a>[i];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    cerr&lt;&lt;<span class="stringliteral">&quot; 成交 | 合约:&quot;</span>&lt;&lt; pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#a2c5a0c76f414fea7812a5092ac76d935" title="合约代码">InstrumentID</a> </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 方向:&quot;</span>&lt;&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">MapDirection</a>(pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#adab15c487c78f7167aeaf21c23c07ada" title="买卖方向">Direction</a>,<span class="keyword">false</span>)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 开平:&quot;</span>&lt;&lt;<a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ab5a608415c729226cb7d80e01e191857">MapOffset</a>(pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#a87882fee9cc99899eb88c97d554aa2d4" title="开平标志">OffsetFlag</a>,<span class="keyword">false</span>) </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 价格:&quot;</span>&lt;&lt;pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#a3bdcbc27d02d8d086975fb3e3c86e65b" title="价格">Price</a></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 数量:&quot;</span>&lt;&lt;pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#ab27ab161941682bd1fbd79c4cf1b5b03" title="数量">Volume</a></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 报单编号:&quot;</span>&lt;&lt;pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#af80ec1684d3c59c7dde4ce038f1cd7cd" title="报单编号">OrderSysID</a></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; 成交编号:&quot;</span>&lt;&lt;pTrade-&gt;<a class="code" href="../../d9/d1f/structCThostFtdcTradeField.html#add29b05cd4578675a43905a5daa23c73" title="成交编号">TradeID</a>&lt;&lt;endl;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ac4e459fde6d5c62a165fc6453a25410f">sem</a>.<a class="code" href="../../d1/d9c/classCSem.html#a80a4a4c55fd118fb56daef5cc1663d7a">sem_v</a>();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">  364</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#aac9054bca36d93c638592dd53660794b">MapDirection</a>(<span class="keywordtype">char</span> src, <span class="keywordtype">bool</span> toOrig=<span class="keyword">true</span>){</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span>(toOrig){</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;b&#39;</span>==src||<span class="charliteral">&#39;B&#39;</span>==src){src=<span class="charliteral">&#39;0&#39;</span>;}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="charliteral">&#39;s&#39;</span>==src||<span class="charliteral">&#39;S&#39;</span>==src){src=<span class="charliteral">&#39;1&#39;</span>;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;0&#39;</span>==src){src=<span class="charliteral">&#39;B&#39;</span>;}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="charliteral">&#39;1&#39;</span>==src){src=<span class="charliteral">&#39;S&#39;</span>;}</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">return</span> src;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ab5a608415c729226cb7d80e01e191857">  372</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="../../dc/d76/CtpTraderSpi_8cpp.html#ab5a608415c729226cb7d80e01e191857">MapOffset</a>(<span class="keywordtype">char</span> src, <span class="keywordtype">bool</span> toOrig=<span class="keyword">true</span>){</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">if</span>(toOrig){</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;o&#39;</span>==src||<span class="charliteral">&#39;O&#39;</span>==src){src=<span class="charliteral">&#39;0&#39;</span>;}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="charliteral">&#39;c&#39;</span>==src||<span class="charliteral">&#39;C&#39;</span>==src){src=<span class="charliteral">&#39;1&#39;</span>;}</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="charliteral">&#39;j&#39;</span>==src||<span class="charliteral">&#39;J&#39;</span>==src){src=<span class="charliteral">&#39;3&#39;</span>;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>(<span class="charliteral">&#39;0&#39;</span>==src){src=<span class="charliteral">&#39;O&#39;</span>;}</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="charliteral">&#39;1&#39;</span>==src){src=<span class="charliteral">&#39;C&#39;</span>;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="charliteral">&#39;3&#39;</span>==src){src=<span class="charliteral">&#39;J&#39;</span>;}</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> src;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_7b5c8aaee22d6e59f9de8f9095b5946f.html">ctpdemo</a></li><li class="navelem"><a class="el" href="../../dc/d76/CtpTraderSpi_8cpp.html">CtpTraderSpi.cpp</a></li>
    <li class="footer">Generated on Mon Jan 27 2014 17:02:11 for EasyQuant by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
